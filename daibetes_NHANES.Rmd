---
title: Is sleep trouble associated with Type II diabetes, after adjusting other factors?
author: "Wanda L"
output:
  pdf_document: default
  html_notebook: default
  word_document: default
---
# WHAT IS NHANES?

The NHANES survey is conducted by the US CDC. See \url{https://www.cdc.gov/nchs/nhanes/about_nhanes.htm}. These surveys have been conducted since the 1960’s.

Starting in 1999, about 5,000 individuals of all ages have been interviewed every year and then they complete the health examination component of the survey. Part of this dataset is made available via the NHANES package which can be loaded this way:

```{r}
data(NHANES) 
dim(NHANES)
summary(NHANES)
view(NHANES)
```
Before we start, it is necessary run the packages that we are going to use, in this case would be: 

```{r setup}
library(tidyverse)
library(gtsummary)
library(NHANES)
library(ggplot2)
```


## **Question: Is sleep trouble associated with Type II diabetes, after adjusting other factors?**

It has been shown that there is a relationship between type II diabetes and sleep problems, several studies suggest that sleep problems are associated with an increased risk of developing type II diabetes. Sleep trouble may alter metabolic, endocrine, and inflammatory pathways, thereby increasing diabetes risk (Cappuccio et al., 2010; Darraj, 2023).
Furthermore, factors such as depression, higher body mass index (BMI), older age, lower socioeconomic status, education, and some racial and ethnic background have all been linked to higher rates of diabetes (Knol et al., 2006; Hill-Briggs et al., 2021; Spanakis & Golden, 2013). 

### Hypothesis

People with sleep trouble are more likely to have diabetes type II, even after adjusting for other risk factors

### Preparing the data

First we need to select only the data that we will use, in this case of Diabetes is caused for Sleep trouble and if Age, gender or Race are related.

```{r}
NHANES %>% select(Diabetes, SleepTrouble, Age, BMI, PhysActive, Education, Race1, Depressed, Poverty)
Sleep_data <-NHANES %>% select(Diabetes, SleepTrouble, Age, BMI, PhysActive, Education, Race1, Depressed, Poverty) %>% filter(!is.na(Diabetes),!is.na(SleepTrouble), !is.na(Age), !is.na(Education), !is.na(Race1),  !is.na(Depressed), !is.na(Poverty))
summary(Sleep_data)

```

### Graphics models

To have an overview of the relationship between diabetes and other factors, a graphic model of each of them was created.

```{r Graphics}
Sleep_data %>%  ggplot(aes(x=SleepTrouble, fill= Diabetes )) + geom_bar(position="fill") + scale_y_continuous(labels = scales::percent) + labs(y = "Proportion", title = "Prevalence of Sleep trouble in Diabetes II patients")
Sleep_data %>%  ggplot(aes(x=Age, fill= Diabetes )) + geom_boxplot() + labs(title = "Percentage of Diabetes II patients by Age")
Sleep_data %>%  ggplot(aes(x=BMI, fill= Diabetes )) + geom_boxplot()+ labs( title = "Percentage of Diabetes II patients by BMI") 
Sleep_data %>%  ggplot(aes(x=PhysActive, fill= Diabetes)) + geom_bar() + labs(y = "Proportion", title = "Prevalence of Physical Activity in Diabetes II patients") 
Sleep_data %>% ggplot(aes(x = Education, fill = Diabetes)) + geom_bar(position = "fill") + scale_y_continuous(labels = scales::percent) + labs(y = "Proportion", title = "Percentage of Diabetes II patients by Education Level")
Sleep_data %>% ggplot(aes(x = Race1, fill = Diabetes)) + geom_bar(position = "fill") + scale_y_continuous(labels = scales::percent) + labs(y = "Proportion", title = "Percentage of Diabetes II patients by Race") 
Sleep_data %>%  ggplot(aes(x=Depressed, fill= Diabetes)) + geom_bar(position="fill") + scale_y_continuous(labels = scales::percent) + labs(y = "Proportion", title = "Prevalence of depression in Diabetes II patients")

Sleep_data %>%  ggplot(aes(x=Poverty, fill= Diabetes)) + geom_boxplot()  + labs(y = "Proportion", title = "Percentage of Diabetes II patients by Poverty")
```

## Evaluation  of Type 2 Diabetes between Sleep troubles and other factors

```{r}
Sleep_data_glm<-glm(Diabetes ~ SleepTrouble + Age + BMI+ PhysActive + Education + Depressed + Poverty, data= Sleep_data, family = binomial(link = "logit"))
summary(Sleep_data_glm)


```
```{r}
odds_ratios <- exp(coef(Sleep_data_glm))
print(odds_ratios)
```


**Interpretation:**

People who reported trouble sleeping were about 23% more likely to have diabetes than those who didn’t have sleep problems. Also, for each year older someone is, and for every extra point in BMI, the odds of having diabetes go up by 6% and 9%, respectively. People who felt depressed most of the time had about 79% higher odds of diabetes compared to those who didn’t feel depressed. Having only up to an 8th grade education increased the odds of diabetes by about 96%, while being a college graduate was linked to 19% lower odds, both compared to people with some college education. Physical activity seemed to reduce the odds of diabetes just a little, but this wasn’t significant in my model. After looking at the graphs, I also found that ethnicity didn’t seem to be a significant factor in diabetes risk. So overall, the biggest factors tied to higher odds of diabetes in my analysis were trouble sleeping, older age, higher BMI, feeling depressed most of the time, and lower education level.


